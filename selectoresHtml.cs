<ul id="ufLista_items" class="ui-selectonemenu-items ui-selectonemenu-list ui-widget-content ui-widget ui-corner-all ui-helper-reset" role="listbox" aria-activedescendant="ufLista_0" zn_id="32"><li class="ui-selectonemenu-item ui-selectonemenu-list-item ui-corner-all ui-noselection-option ui-state-highlight" data-label="-- Selecione --" tabindex="-1" role="option" aria-selected="true" id="ufLista_0" zn_id="43">-- Selecione --</li><li class="ui-selectonemenu-item ui-selectonemenu-list-item ui-corner-all" data-label="ACRE" tabindex="-1" role="option" aria-selected="false" id="ufLista_1" zn_id="44">ACRE</li><li class="ui-selectonemenu-item ui-selectonemenu-list-item ui-corner-all" data-label="ALAGOAS" tabindex="-1" role="option" aria-selected="false" id="ufLista_2" zn_id="45">ALAGOAS</li><li class="ui-selectonemenu-item ui-selectonemenu-list-item ui-corner-all" data-label="AMAZONAS" tabindex="-1" role="option" aria-selected="false" id="ufLista_3" zn_id="46">AMAZONAS</li><li class="ui-selectonemenu-item ui-selectonemenu-list-item ui-corner-all" data-label="AMAPÁ" tabindex="-1" role="option" aria-selected="false" id="ufLista_4" zn_id="47">AMAPÁ</li><li class="ui-selectonemenu-item ui-selectonemenu-list-item ui-corner-all" data-label="BAHIA" tabindex="-1" role="option" aria-selected="false" id="ufLista_5" zn_id="48">BAHIA</li><li class="ui-selectonemenu-item ui-selectonemenu-list-item ui-corner-all" data-label="CEARÁ" tabindex="-1" role="option" aria-selected="false" id="ufLista_6" zn_id="49">CEARÁ</li><li class="ui-selectonemenu-item ui-selectonemenu-list-item ui-corner-all" data-label="DISTRITO FEDERAL" tabindex="-1" role="option" aria-selected="false" id="ufLista_7" zn_id="50">DISTRITO FEDERAL</li><li class="ui-selectonemenu-item ui-selectonemenu-list-item ui-corner-all" data-label="ESPÍRITO SANTO" tabindex="-1" role="option" aria-selected="false" id="ufLista_8" zn_id="51">ESPÍRITO SANTO</li><li class="ui-selectonemenu-item ui-selectonemenu-list-item ui-corner-all" data-label="GOIÁS" tabindex="-1" role="option" aria-selected="false" id="ufLista_9" zn_id="52">GOIÁS</li><li class="ui-selectonemenu-item ui-selectonemenu-list-item ui-corner-all" data-label="MARANHÃO" tabindex="-1" role="option" aria-selected="false" id="ufLista_10" zn_id="53">MARANHÃO</li><li class="ui-selectonemenu-item ui-selectonemenu-list-item ui-corner-all" data-label="MINAS GERAIS" tabindex="-1" role="option" aria-selected="false" id="ufLista_11" zn_id="54">MINAS GERAIS</li><li class="ui-selectonemenu-item ui-selectonemenu-list-item ui-corner-all" data-label="MATO GROSSO DO SUL" tabindex="-1" role="option" aria-selected="false" id="ufLista_12" zn_id="55">MATO GROSSO DO SUL</li><li class="ui-selectonemenu-item ui-selectonemenu-list-item ui-corner-all" data-label="MATO GROSSO" tabindex="-1" role="option" aria-selected="false" id="ufLista_13" zn_id="56">MATO GROSSO</li><li class="ui-selectonemenu-item ui-selectonemenu-list-item ui-corner-all" data-label="PARÁ" tabindex="-1" role="option" aria-selected="false" id="ufLista_14" zn_id="57">PARÁ</li><li class="ui-selectonemenu-item ui-selectonemenu-list-item ui-corner-all" data-label="PARAÍBA" tabindex="-1" role="option" aria-selected="false" id="ufLista_15" zn_id="58">PARAÍBA</li><li class="ui-selectonemenu-item ui-selectonemenu-list-item ui-corner-all" data-label="PERNAMBUCO" tabindex="-1" role="option" aria-selected="false" id="ufLista_16" zn_id="59">PERNAMBUCO</li><li class="ui-selectonemenu-item ui-selectonemenu-list-item ui-corner-all" data-label="PIAUÍ" tabindex="-1" role="option" aria-selected="false" id="ufLista_17" zn_id="60">PIAUÍ</li><li class="ui-selectonemenu-item ui-selectonemenu-list-item ui-corner-all" data-label="PARANÁ" tabindex="-1" role="option" aria-selected="false" id="ufLista_18" zn_id="61">PARANÁ</li><li class="ui-selectonemenu-item ui-selectonemenu-list-item ui-corner-all" data-label="RIO DE JANEIRO" tabindex="-1" role="option" aria-selected="false" id="ufLista_19" zn_id="62">RIO DE JANEIRO</li><li class="ui-selectonemenu-item ui-selectonemenu-list-item ui-corner-all" data-label="RIO GRANDE DO NORTE" tabindex="-1" role="option" aria-selected="false" id="ufLista_20" zn_id="63">RIO GRANDE DO NORTE</li><li class="ui-selectonemenu-item ui-selectonemenu-list-item ui-corner-all" data-label="RONDÔNIA" tabindex="-1" role="option" aria-selected="false" id="ufLista_21" zn_id="64">RONDÔNIA</li><li class="ui-selectonemenu-item ui-selectonemenu-list-item ui-corner-all" data-label="RORAIMA" tabindex="-1" role="option" aria-selected="false" id="ufLista_22" zn_id="35">RORAIMA</li><li class="ui-selectonemenu-item ui-selectonemenu-list-item ui-corner-all" data-label="RIO GRANDE DO SUL" tabindex="-1" role="option" aria-selected="false" id="ufLista_23" zn_id="65">RIO GRANDE DO SUL</li><li class="ui-selectonemenu-item ui-selectonemenu-list-item ui-corner-all" data-label="SANTA CATARINA" tabindex="-1" role="option" aria-selected="false" id="ufLista_24" zn_id="66">SANTA CATARINA</li><li class="ui-selectonemenu-item ui-selectonemenu-list-item ui-corner-all" data-label="SERGIPE" tabindex="-1" role="option" aria-selected="false" id="ufLista_25" zn_id="67">SERGIPE</li><li class="ui-selectonemenu-item ui-selectonemenu-list-item ui-corner-all" data-label="SÃO PAULO" tabindex="-1" role="option" aria-selected="false" id="ufLista_26" zn_id="68">SÃO PAULO</li><li class="ui-selectonemenu-item ui-selectonemenu-list-item ui-corner-all" data-label="TOCANTINS" tabindex="-1" role="option" aria-selected="false" id="ufLista_27" zn_id="69">TOCANTINS</li></ul>


boolErrorSeleccionUf = false;
// Filtrar filas que NO contengan '*'
System.Collections.Generic.IEnumerable<System.Data.DataRow> filasFiltradasEnumerable = tablaUfSeleccionado.AsEnumerable()
    .Where(row => !row.Field<System.String>(0).Contains("*"));
if(filasFiltradasEnumerable != null){
   // Verificar si hay filas filtradas antes de convertir a DataTable
   System.Data.DataTable filasFiltradas = filasFiltradasEnumerable.Any() ? filasFiltradasEnumerable.CopyToDataTable() : new System.Data.DataTable();
   // Si no hay filas filtradas, asigna "ACRE", de lo contrario, asigna el primer valor filtrado
   nombreUfSeleccionado = filasFiltradas.Rows[0][0].ToString().Trim();
   Console.WriteLine(nombreUfSeleccionado+" NOMBRE DE UF SELECCIONADO");
    
   //scriptJsSelectorUf = string.Format("document.getElementById('{0}').click();",selectoUf);
   
   // SELECTOR DE UF DEPENDIENDO DEL ARCHIVO CSV UF
   // Mapeo de estados con su número de índice en el XPath
   System.Collections.Generic.Dictionary<string, int> mapeoUf = new System.Collections.Generic.Dictionary<string, int>
   {
       { "ACRE", 2 }, { "ALAGOAS", 3 }, { "AMAPÁ", 5 }, { "AMAZONAS", 4 }, { "BAHIA", 6 },
       { "CEARÁ", 7 }, { "DISTRITO FEDERAL", 8 }, { "ESPÍRITO SANTO", 9 }, { "GOIÁS", 10 },
       { "MARANHÃO", 11 }, { "MATO GROSSO", 12 }, { "MATO GROSSO DO SUL", 13 }, { "MINAS GERAIS", 14 },
       { "PARANÁ", 15 }, { "PARAÍBA", 16 }, { "PARÁ", 17 }, { "PERNAMBUCO", 18 }, { "PIAUÍ", 19 },
       { "RIO DE JANEIRO", 20 }, { "RIO GRANDE DO NORTE", 21 }, { "RIO GRANDE DO SUL", 24 },
       { "RONDÔNIA", 22 }, { "RORAIMA", 23 }, { "SANTA CATARINA", 25 }, { "SERGIPE", 26 },
       { "SÃO PAULO", 27 }, { "TOCANTINS", 28 }
   };

   // Verificar si el estado existe en el diccionario
   int numeroLista = mapeoUf.ContainsKey(nombreUfSeleccionado) ? mapeoUf[nombreUfSeleccionado] : 1;
   // Construcción dinámica del XPath
   selectorUfSeleccionado = string.Format("/html/body/div[6]/div/ul/li[{0}]", numeroLista);
   // Mostrar el resultado
   System.Console.WriteLine(selectorUfSeleccionado);
 
   
   // Construir el script en JavaScript con String.Format()
   scriptJsClickSelectorUf = System.String.Format(@"
       // Evaluar el XPath y seleccionar el elemento
       var xpath = ""{0}"";
       var elemento = document.evaluate(xpath, document, null, XPathResult.FIRST_ORDERED_NODE_TYPE, null).singleNodeValue;
   
       // Verificar si el elemento existe y hacer clic
       if (elemento) {{
           elemento.click(); // Hacer clic en el elemento
       }} else {{
   
       }}
   ", selectorUfSeleccionado);


}else{
  boolErrorSeleccionUf = true;
}

boolErrorSeleccionUf = false;
// Filtrar filas que NO contengan '*'
System.Collections.Generic.IEnumerable<System.Data.DataRow> filasFiltradasEnumerable = tablaUfSeleccionado.AsEnumerable()
    .Where(row => !row.Field<System.String>(0).Contains("*"));

if (filasFiltradasEnumerable != null)
{
    // Verificar si hay filas filtradas antes de convertir a DataTable
    System.Data.DataTable filasFiltradas = filasFiltradasEnumerable.Any() ? filasFiltradasEnumerable.CopyToDataTable() : new System.Data.DataTable();
    // Si no hay filas filtradas, asigna "ACRE", de lo contrario, asigna el primer valor filtrado
    nombreUfSeleccionado = filasFiltradas.Rows[0][0].ToString().Trim();
    Console.WriteLine(nombreUfSeleccionado + " NOMBRE DE UF SELECCIONADO");

    // Mapeo de estados con su ID del elemento en el HTML
    System.Collections.Generic.Dictionary<string, string> mapeoUfId = new System.Collections.Generic.Dictionary<string, string>
    {
        { "ACRE", "ufLista_1" }, { "ALAGOAS", "ufLista_2" }, { "AMAZONAS", "ufLista_3" }, { "AMAPÁ", "ufLista_4" },
        { "BAHIA", "ufLista_5" }, { "CEARÁ", "ufLista_6" }, { "DISTRITO FEDERAL", "ufLista_7" },
        { "ESPÍRITO SANTO", "ufLista_8" }, { "GOIÁS", "ufLista_9" }, { "MARANHÃO", "ufLista_10" },
        { "MINAS GERAIS", "ufLista_11" }, { "MATO GROSSO DO SUL", "ufLista_12" }, { "MATO GROSSO", "ufLista_13" },
        { "PARÁ", "ufLista_14" }, { "PARAÍBA", "ufLista_15" }, { "PERNAMBUCO", "ufLista_16" }, { "PIAUÍ", "ufLista_17" },
        { "PARANÁ", "ufLista_18" }, { "RIO DE JANEIRO", "ufLista_19" }, { "RIO GRANDE DO NORTE", "ufLista_20" },
        { "RONDÔNIA", "ufLista_21" }, { "RORAIMA", "ufLista_22" }, { "RIO GRANDE DO SUL", "ufLista_23" },
        { "SANTA CATARINA", "ufLista_24" }, { "SERGIPE", "ufLista_25" }, { "SÃO PAULO", "ufLista_26" },
        { "TOCANTINS", "ufLista_27" }
    };

    string idElementoUf = mapeoUfId.ContainsKey(nombreUfSeleccionado) ? mapeoUfId[nombreUfSeleccionado] : "ufLista_0";

    scriptJsClickSelectorUf = System.String.Format(@"
        var elemento = document.getElementById('{0}');
        if (elemento) {{
            elemento.click();
        }} else {{
            console.log('Elemento no encontrado');
        }}
    ", idElementoUf);

    System.Console.WriteLine(scriptJsClickSelectorUf);
}
else
{
    boolErrorSeleccionUf = true;
}
